<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

	<h:head>
		<meta http-equiv="content-type" content="text/xhtml"; charset="ISO-8859-1" />
		<!-- Eliminar estas 4 líneas para PRODUCCIÓN -->
		<!-- Con ellas evitamos que el CACHÉ IMPIDA la actualización de estilos -->
		  <meta http-equiv="Expires" content="0">
		  <meta http-equiv="Last-Modified" content="0">
		  <meta http-equiv="Cache-Control" content="no-cache, mustrevalidate">
		  <meta http-equiv="Pragma" content="no-cache">
		
				
		<title>Vista Listado Contactos</title>
		<h:outputStylesheet library="css" type="text/css" name="${pageContext.request.contextPath}/recursos/ccs/TablaCSS1.css"/>
	</h:head>
	<h:body>

		<h1>Vista Listado de Contactos</h1>
	    <h:form id="formListado">			
		<p:dataTable tableid="tablaContactos" paginator="true" paginatorPosition="bottom" rows="10" var="contacto" value="#{ContactoControlador.listadoContactos}" emptyMessage="No existen contactos">
	        <p:column headerText="ID">
	            <h:outputText value="#{contacto.id}" />
	        </p:column>
	        <p:column headerText="Nombre">
	            <h:outputText value="#{contacto.nombre}" />
	        </p:column>
	        <p:column headerText="Descripción">
	            <h:outputText value="#{contacto.descripcion}" />
	        </p:column>

            <p:column headerText="Modificar" style="text-align: center">
                <p:commandButton icon="ui-icon-pencil" title="Modificar" oncomplete="PF('dialogoModificar').show();" update=":formModificar">
                    <f:setPropertyActionListener target="#{contactoControlador.contacto}" value="#{contacto}"/>
                </p:commandButton>
            </p:column>
            <p:column headerText="ELIMINAR" style="text-align: center">
                <p:commandButton icon="ui-icon-trash" title="Eliminar" oncomplete="PF('dialogoEliminar').show();" update=":formEliminar">
                    <f:setPropertyActionListener target="#{contactoControlador.contacto}" value="#{contacto}"/>
                </p:commandButton>
            </p:column>
        </p:dataTable>
        </h:form>
        <h:form>
			<p:commandButton icon="pi-sign-out" title="Regresar" oncomplete="" update=":formIndex">
                    <f:setPropertyActionListener target="#{contactoControlador.contacto}" value=""/>
        	</p:commandButton>
       	</h:form>

        
        <h:form id="formAgregar">
                        <p:dialog id="dlgAgregar" header="Agregar Contacto" widgetVar="dialogoAgregar" resizable="false" showEffect="fade" hideEffect="explode" modal="true">
                            <p:panelGrid columns="2" style="margin: 0 auto;">                                
                                <p:outputLabel value="Nombre:"/>
                                <p:inputText value="#{contactoControlador.contacto.nombre}"/>
                                <p:outputLabel value="Descripción"/>
                                <p:inputText value="#{contactoControlador.contacto.descripcion}"/>
                            </p:panelGrid>                        
                            <p:commandButton  value="Guardar" actionListener="#{contactoControlador.agregarContacto()}" update=":formListado:tablaContactos" oncomplete="PF('dialogoAgregar').hide();"/>
                            <p:commandButton  value="Cancelar" onclick="PF('dialogoAgregar').hide();"/>
                        </p:dialog>
        </h:form>
                    
		<h:form id="formModificar">
			            <p:dialog id="dlgModificar" header="Modificar Contacto" widgetVar="dialogoModificar" resizable="false" showEffect="fade" hideEffect="explode" modal="true">
			                <p:panelGrid columns="2" style="margin: 0 auto;">                                
                                <p:outputLabel value="Nombre:"/>
                                <p:inputText value="#{contactoControlador.contacto.nombre}"/>
                                <p:outputLabel value="Descripción"/>
                                <p:inputText value="#{contactoControlador.contacto.descripcion}"/>                    
		                </p:panelGrid>
		                <p:commandButton  value="Guardar" actionListener="#{contactoControlador.modificarContacto()}" update=":formListado:tablaContactos" oncomplete="PF('dialogoModificar').hide();"/>
		                <p:commandButton  value="Cancelar" onclick="PF('dialogoModificar').hide();"/>
		            </p:dialog>
		</h:form>

		<h:form id="formEliminar">
		            <p:dialog id="dlgEliminar" header="Eliminar Contacto" widgetVar="dialogoEliminar" resizable="false" showEffect="fade" hideEffect="explode" modal="true">
		                <h:outputText value="Desea eliminar este registro?"/>
		                <p:commandButton  value="Si" actionListener="#{ContactoControlador.eliminarContacto()}" update=":formListado:tablaContactos" oncomplete="PF('dialogoEliminar').hide();"/>
		                <p:commandButton  value="No" onclick="PF('dialogoEliminar').hide();"/>
		            </p:dialog>
		</h:form>

    </h:body>
</html>

		